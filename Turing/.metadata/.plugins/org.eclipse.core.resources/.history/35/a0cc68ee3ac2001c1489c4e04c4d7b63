package it.beije.turing.rubrica.criteria;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import javax.persistence.Entity;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;
import javax.persistence.TypedQuery;
import javax.persistence.criteria.CriteriaBuilder;
import javax.persistence.criteria.CriteriaDelete;
import javax.persistence.criteria.CriteriaQuery;
import javax.persistence.criteria.CriteriaUpdate;
import javax.persistence.criteria.Root;

import org.hibernate.Session;

import javax.persistence.Query;

import it.beije.turing.db.HBsessionFactory;
import it.beije.turing.rubrica.Contatto;



/*Implementare un gestore di rubrica a linea di comando, con le seguenti fu
 * nzionalità:
vedi lista contatti (con possibilità di ordinare per nome e cognome a scelta)

cerca contatto
inserisci nuovo contatto
modifica contatto
cancella contatto
trova contatti duplicati
unisci contatti duplicati

La rubrica deve essere memorizzata su DB e deve esserci la possibilità di importare ed
esportare contatti da/in file XML e CSV*/



public class Rubrica {
	
	public static void importCSV(String csvPath, String sep) {
		
		
		FileReader fileReader = null;
		BufferedReader bufferedReader = null;
		List<Contatto> contatti = null;
		
		try {
			fileReader = new FileReader(csvPath);
			
			bufferedReader = new BufferedReader(fileReader);
			
			int c = 0;
			contatti = new ArrayList<Contatto>();
			Contatto contatto = null;
			
			while (bufferedReader.ready()) {
				String row = bufferedReader.readLine();
				
				System.out.println(++c + " " + row);
				
				row = row.substring(1, row.length() - 1);
				String[] columns = row.split(sep);
				
				
				contatto = new Contatto();
				if(columns.length < 0) {
					if(columns[1] != null)
					contatto.setNome(columns[0]);
					else
						contatto.setNome(null);
				}
				contatto.setNome(columns[0]);
				contatto.setCognome(columns[1]);
				contatto.setTelefono(columns[2]);
				contatto.setEmail(columns[3]);
//				contatto.setNote(columns[4]);
				
				System.out.println(contatto);
		
				contatti.add(contatto);
				//Util.insert(contatto);
				
			}
		} catch (IOException ioEx) {
			ioEx.printStackTrace();
		} finally {
			try {
				bufferedReader.close();
				fileReader.close();
			} catch (IOException fEx) {
				fEx.printStackTrace();
			}
		}
		
		
	}
	
	
	public static void main(String[] args) {
		
		importCSV("/Users/matteoprovezza/Desktop/xml/rubrica_tel.csv", ";");
		
		
		
	}

}
